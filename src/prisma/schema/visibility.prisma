model Visibility {
  id           Int                     @id @default(autoincrement())
  requirements VisibilityRequirement[] // You must fullfill all requirements
  createdAt    DateTime                @default(now())
  updatedAt    DateTime                @updatedAt

  imageCollectionAdmin ImageCollection? @relation(name: "ImageCollectionAdminVisibility")
  imageCollectionRead  ImageCollection? @relation(name: "ImageCollectionReadVisibility")
}

model VisibilityRequirement {
  id                          Int                          @id @default(autoincrement())
  visibility                  Visibility                   @relation(fields: [visibilityId], references: [id], onDelete: Cascade)
  visibilityId                Int
  visibilityRequirementGroups VisibilityRequirementGroup[] //must be in one of these to fullfill this requirement
}

enum VisibilityRequirementGroupType {
  ACTIVE
  ORDER
}

model VisibilityRequirementGroup {
  id                      Int                            @id @default(autoincrement())
  visibilityRequirement   VisibilityRequirement          @relation(fields: [visibilityRequirementId], references: [id], onDelete: Cascade)
  visibilityRequirementId Int
  group                   Group                          @relation(fields: [groupId], references: [id], onDelete: Cascade)
  groupId                 Int
  type                    VisibilityRequirementGroupType
  omegaOrder              OmegaOrder                     @relation(fields: [order], references: [order], onDelete: Restrict)
  order                   Int

  @@unique([visibilityRequirementId, groupId, order])
}
